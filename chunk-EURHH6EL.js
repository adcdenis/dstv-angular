import{a as te}from"./chunk-FURQSZNK.js";import{a as ue,b as _e}from"./chunk-YOAYV4RA.js";import"./chunk-2JY635KS.js";import{a as ve,b as Ce}from"./chunk-6BD7PSS4.js";import{a as fe,b as ge}from"./chunk-5WWM3MYI.js";import"./chunk-WSDER2HD.js";import"./chunk-T6OX34SV.js";import{b as he}from"./chunk-MSYTDTXD.js";import{b as X}from"./chunk-4CYYGYMS.js";import{a as ee}from"./chunk-TYLBSFVV.js";import{a as Se,b as xe}from"./chunk-DTX2IFH6.js";import"./chunk-3CQIXJFX.js";import{b as be}from"./chunk-W22XDKEB.js";import"./chunk-4JDA26ZU.js";import{a as re,d as se,e as pe,h as me,i as ce,k as de}from"./chunk-ION2EUQK.js";import"./chunk-XCSSQDET.js";import"./chunk-V5XYQFDX.js";import"./chunk-MZURXKLX.js";import"./chunk-3AW6TXZQ.js";import{b as le,c as ae}from"./chunk-LJGI4ZRP.js";import"./chunk-T2PIK6R3.js";import"./chunk-SFTIWTHH.js";import"./chunk-7SPUUUGD.js";import{i as ie}from"./chunk-WSIWJYJX.js";import"./chunk-NJPLBFLS.js";import"./chunk-MDZH7E7N.js";import"./chunk-V6X5IB37.js";import"./chunk-3GJN2BSD.js";import"./chunk-MBI4S36B.js";import"./chunk-6LXUGSQP.js";import{a as oe,b as ne}from"./chunk-UGHG6TU3.js";import"./chunk-UAXJ67OE.js";import{b as H,e as Q,g as Y,k as K,n as J}from"./chunk-KLIUDW4T.js";import"./chunk-S35HUXPS.js";import{b as Z,d as $}from"./chunk-4B2QLF32.js";import{k as V,p as U,s as q,t as G}from"./chunk-BFP4OEA6.js";import{Aa as h,Bb as L,F as w,Ja as D,Ka as s,L as m,La as I,M as c,Ma as M,Oa as v,Pa as C,Qa as P,Ra as j,Sa as S,Ta as F,Tb as B,Y as p,Z as y,da as O,ea as E,ja as g,ma as d,pa as T,rb as A,sa as n,ta as o,tb as z,ua as f,ya as x,za as b}from"./chunk-UX7NIMCO.js";import"./chunk-EQC2ISW6.js";import"./chunk-YT5AF7SN.js";import{a as W,h as k}from"./chunk-MG3ERZGY.js";var Te=()=>["valor","nome","id"],Me=()=>[10,20,30],R=()=>({width:"450px"}),N=()=>({"960px":"50vw","640px":"90vw"}),Pe=t=>({"ng-invalid ng-dirty":t});function Ve(t,u){if(t&1){let i=x();n(0,"div",30)(1,"button",31),b("click",function(){m(i);let e=h(2);return c(e.abrirDialogExcluirSelecionados())}),o()()}}function ke(t,u){t&1&&f(0,"p-fileUpload",34),t&2&&d("maxFileSize",1e6)}function Ie(t,u){t&1&&(n(0,"div",32),g(1,ke,1,1,"p-fileUpload",33),o()),t&2&&(p(),d("ngIf",!1))}function Fe(t,u){t&1&&(n(0,"p-toolbar",27),g(1,Ve,2,0,"ng-template",28)(2,Ie,2,1,"ng-template",29),o())}function Be(t,u){if(t&1){let i=x();n(0,"div",35)(1,"h5",36),f(2,"i",37),s(3,"Gerenciar Planos"),o(),n(4,"span",38),f(5,"i",39),n(6,"input",40),b("input",function(e){m(i);let r=h(),_=D(6);return c(r.onGlobalFilter(_,e))}),o()()()}}function Re(t,u){t&1&&(n(0,"th",46),s(1,"Id "),f(2,"p-sortIcon",47),o())}function Ne(t,u){t&1&&(n(0,"tr")(1,"th",41),f(2,"p-tableHeaderCheckbox"),o(),g(3,Re,3,0,"th",42),n(4,"th",43),s(5,"Nome "),f(6,"p-sortIcon",44),o(),n(7,"th",45),s(8,"Valor "),f(9,"p-sortIcon",44),o(),f(10,"th"),o()),t&2&&(p(3),d("ngIf",!1))}function We(t,u){if(t&1&&(n(0,"td")(1,"span",49),s(2,"Id"),o(),s(3),o()),t&2){let i=h().$implicit;p(3),M(" ",i.id," ")}}function Oe(t,u){if(t&1){let i=x();n(0,"tr")(1,"td"),f(2,"p-tableCheckbox",48),o(),g(3,We,4,1,"td",13),n(4,"td")(5,"span",49),s(6,"Nome"),o(),s(7),o(),n(8,"td")(9,"span",49),s(10,"Valor"),o(),s(11),o(),n(12,"td")(13,"div",50)(14,"button",51),b("click",function(){let e=m(i).$implicit,r=h();return c(r.abrirDialogAlterar(e))}),o(),n(15,"button",52),b("click",function(){let e=m(i).$implicit,r=h();return c(r.abrirDialogExcluir(e))}),o()()()()}if(t&2){let i=u.$implicit;p(2),d("value",i),p(),d("ngIf",!1),p(4),M(" ",i.nome," "),p(4),M(" ",i.valor," ")}}function De(t,u){if(t&1&&(n(0,"span"),s(1,"Tem certeza que voc\xEA deseja excluir "),n(2,"b"),s(3),o(),s(4,"?"),o()),t&2){let i=h();p(3),I(i.planoSelecionado.nome)}}function je(t,u){if(t&1){let i=x();n(0,"button",53),b("click",function(){m(i);let e=h();return c(e.dialogoExcluir=!1)}),o(),n(1,"button",54),b("click",function(){m(i);let e=h();return c(e.excluir())}),o()}}function Ae(t,u){t&1&&(n(0,"small",55),s(1,"Nome \xE9 obrigat\xF3rio."),o())}function ze(t,u){t&1&&(n(0,"small",55),s(1,"Valor \xE9 obrigat\xF3rio."),o())}function Le(t,u){if(t&1){let i=x();n(0,"button",53),b("click",function(){m(i);let e=h();return c(e.dialogoExcluirSelecionados=!1)}),o(),n(1,"button",54),b("click",function(){m(i);let e=h();return c(e.excluirSelecionados())}),o()}}var ye=(()=>{class t{constructor(i,l,e){this.planoService=i,this.messageService=l,this.clienteService=e,this.listaPlanos=[],this.listaPlanosSelecionados=[],this.dialogoExcluir=!1,this.dialogoPlano=!1,this.dialogoExcluirSelecionados=!1,this.planoSelecionado={},this.cols=[],this.submitted=!1}ngOnInit(){console.log("aqui"),this.cols=[{field:"id",header:"Id"},{field:"nome",header:"Nome"},{field:"valor",header:"Valor"}],this.planoService.getAll().subscribe({next:i=>this.listaPlanos=i,error:i=>console.error(i),complete:()=>console.info("complete")})}salvarOuAlterar(){if(this.submitted=!0,!this.planoSelecionado.nome||this.planoSelecionado.nome.trim().length==0){this.messageService.add({severity:"error",summary:"Erro!",detail:"Insira um nome!",life:3e3});return}this.planoSelecionado.id?this.alterar():this.salvar()}salvar(){this.planoService.create(this.planoSelecionado).then(()=>{this.dialogoPlano=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Plano Criado!",life:3e3}),this.planoService.getAll().subscribe({next:i=>this.listaPlanos=i,error:i=>console.error(i),complete:()=>console.info("complete")})})}abrirDialogAlterar(i){this.planoSelecionado=W({},i),this.submitted=!1,this.dialogoPlano=!0}alterar(){this.planoService.update(this.planoSelecionado).then(()=>{this.dialogoPlano=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Alterado!",life:3e3}),this.planoService.getAll().subscribe({next:i=>this.listaPlanos=i,error:i=>console.error(i),complete:()=>console.info("complete")})})}abrirDialogExcluir(i){this.submitted=!1,this.planoSelecionado=i,this.dialogoExcluir=!0}excluir(){return k(this,null,function*(){let l=(yield this.clienteService.getByPlano(this.planoSelecionado.id||"")).docs.map(e=>e.data());if(l.length>0){let e=l.map(r=>r.nome).join(", ");this.messageService.add({severity:"error",summary:"Erro ao excluir!",detail:`Este plano n\xE3o pode ser exclu\xEDdo pois est\xE1 sendo utilizado pelos seguintes clientes: ${e}`,life:5e3}),this.dialogoExcluir=!1;return}this.planoService.delete(this.planoSelecionado.id||"").then(()=>{console.info("complete"),this.dialogoExcluir=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Plano Exclu\xEDdo",life:3e3}),this.planoSelecionado={},this.planoService.getAll().subscribe({next:e=>this.listaPlanos=e,error:e=>console.error(e),complete:()=>console.info("complete")})})})}onGlobalFilter(i,l){i.filterGlobal(l.target.value,"contains")}novo(){this.dialogoPlano=!0,this.planoSelecionado={}}abrirDialogExcluirSelecionados(){this.dialogoExcluirSelecionados=!0}excluirSelecionados(){return k(this,null,function*(){if(this.listaPlanosSelecionados){let i=[];for(let l of this.listaPlanosSelecionados){let r=(yield this.clienteService.getByPlano(l.id||"")).docs.map(_=>_.data());r.length>0&&i.push({plano:l,clientes:r})}if(i.length>0){let l=`Os seguintes planos n\xE3o podem ser exclu\xEDdos pois est\xE3o sendo utilizados por clientes:
`;i.forEach(e=>{let r=e.clientes.map(_=>_.nome).join(", ");l+=`
\u2022 ${e.plano.nome}: ${r}`}),this.messageService.add({severity:"error",summary:"Erro ao excluir!",detail:l,life:8e3}),this.dialogoExcluirSelecionados=!1;return}this.listaPlanosSelecionados.forEach(l=>{this.planoService.delete(l.id||"")}),this.dialogoExcluirSelecionados=!1,this.listaPlanosSelecionados=[],this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Planos Exclu\xEDdos",life:3e3}),this.planoService.getAll().subscribe({next:l=>this.listaPlanos=l,error:l=>console.error(l),complete:()=>console.info("complete")})}})}static{this.\u0275fac=function(l){return new(l||t)(y(te),y(V),y(ee))}}static{this.\u0275cmp=O({type:t,selectors:[["app-plano"]],standalone:!1,features:[j([V])],decls:41,vars:47,consts:[["dt",""],[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6","fade-in","list-card"],["styleClass","mb-4 list-toolbar",4,"ngIf"],["styleClass","p-datatable-striped list-table planos-table","responsiveLayout","stack","currentPageReportTemplate","Mostrando {first} at\xE9 {last} de {totalRecords} registros","selectionMode","multiple","dataKey","id",3,"selectionChange","value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-rounded","p-button-success","fab",3,"click"],["header","Confirmar",3,"visibleChange","visible","modal","breakpoints"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Detalhes do Plano",1,"p-fluid",3,"visibleChange","visible","breakpoints","modal"],[1,"p-fluid","grid"],[1,"field","col-12"],["for","name"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModelChange","ngModel","ngClass"],["class","ng-dirty ng-invalid",4,"ngIf"],["for","valor"],["inputId","stacked","mode","currency","currency","BRL","autofocus","",3,"ngModelChange","ngModel","showButtons","ngClass"],[1,"field","col-6"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-danger",3,"click"],["pButton","","pRipple","","label","Salvar","icon","pi pi-check",1,"p-button-success",3,"click"],["header","Confirmar Exclus\xE3o",3,"visibleChange","visible","modal","breakpoints"],["styleClass","mb-4 list-toolbar"],["pTemplate","left"],["pTemplate","right"],[1,"p-toolbar-group-left","flex","flex-wrap","gap-2","w-full"],["pButton","","pRipple","","label","Excluir","icon","pi pi-trash",1,"p-button-danger",3,"click"],[1,"p-toolbar-group-right","flex","flex-wrap","gap-2","w-full","md:w-auto","justify-content-end","mt-2","md:mt-0"],["mode","basic","accept","image/*","label","Import","chooseLabel","Importar","class","inline-block",3,"maxFileSize",4,"ngIf"],["mode","basic","accept","image/*","label","Import","chooseLabel","Importar",1,"inline-block",3,"maxFileSize"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"pi","pi-dollar","mr-2"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Procurar...",1,"w-full","sm:w-auto",3,"input"],[2,"width","3rem"],["pSortableColumn","id",4,"ngIf"],["pSortableColumn","nome"],["field","nome"],["pSortableColumn","valor"],["pSortableColumn","id"],["field","id"],[3,"value"],[1,"p-column-title"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","N\xE3o",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Sim",1,"p-button-text",3,"click"],[1,"ng-dirty","ng-invalid"]],template:function(l,e){if(l&1){let r=x();n(0,"div",1)(1,"div",2)(2,"div",3),f(3,"p-toast"),g(4,Fe,3,0,"p-toolbar",4),n(5,"p-table",5,0),P("selectionChange",function(a){return m(r),C(e.listaPlanosSelecionados,a)||(e.listaPlanosSelecionados=a),c(a)}),g(7,Be,7,0,"ng-template",6)(8,Ne,11,1,"ng-template",7)(9,Oe,16,4,"ng-template",8),o()(),n(10,"button",9),b("click",function(){return m(r),c(e.novo())}),o(),n(11,"p-dialog",10),P("visibleChange",function(a){return m(r),C(e.dialogoExcluir,a)||(e.dialogoExcluir=a),c(a)}),n(12,"div",11),f(13,"i",12),g(14,De,5,1,"span",13),o(),g(15,je,2,0,"ng-template",14),o(),n(16,"p-dialog",15),P("visibleChange",function(a){return m(r),C(e.dialogoPlano,a)||(e.dialogoPlano=a),c(a)}),n(17,"div",16)(18,"div",17)(19,"label",18),s(20,"Nome:"),o(),n(21,"input",19),P("ngModelChange",function(a){return m(r),C(e.planoSelecionado.nome,a)||(e.planoSelecionado.nome=a),c(a)}),o(),g(22,Ae,2,0,"small",20),o(),n(23,"div",17)(24,"label",21),s(25,"Valor:"),o(),n(26,"p-inputNumber",22),P("ngModelChange",function(a){return m(r),C(e.planoSelecionado.valor,a)||(e.planoSelecionado.valor=a),c(a)}),o(),g(27,ze,2,0,"small",20),o(),n(28,"div",23)(29,"button",24),b("click",function(){return m(r),c(e.dialogoPlano=!1)}),o()(),n(30,"div",23)(31,"button",25),b("click",function(){return m(r),c(e.salvarOuAlterar())}),o()()()(),n(32,"p-dialog",26),P("visibleChange",function(a){return m(r),C(e.dialogoExcluirSelecionados,a)||(e.dialogoExcluirSelecionados=a),c(a)}),n(33,"div",11),f(34,"i",12),n(35,"span"),s(36,"Tem certeza que voc\xEA deseja excluir os "),n(37,"b"),s(38),o(),s(39," planos selecionados?"),o()(),g(40,Le,2,0,"ng-template",14),o()()()}l&2&&(p(4),d("ngIf",e.listaPlanosSelecionados&&e.listaPlanosSelecionados.length>0),p(),d("value",e.listaPlanos)("columns",e.cols)("rows",10)("globalFilterFields",S(35,Te))("rows",10)("paginator",!0)("rowsPerPageOptions",S(36,Me))("showCurrentPageReport",!0),v("selection",e.listaPlanosSelecionados),d("rowHover",!0),p(6),T(S(37,R)),v("visible",e.dialogoExcluir),d("modal",!0)("breakpoints",S(38,N)),p(3),d("ngIf",e.planoSelecionado),p(2),T(S(39,R)),v("visible",e.dialogoPlano),d("breakpoints",S(40,N))("modal",!0),p(5),v("ngModel",e.planoSelecionado.nome),d("ngClass",F(41,Pe,e.submitted&&!e.planoSelecionado.nome)),p(),d("ngIf",e.submitted&&!e.planoSelecionado.nome),p(4),v("ngModel",e.planoSelecionado.valor),d("showButtons",!1)("ngClass",F(43,Pe,e.submitted&&!e.planoSelecionado.valor)),p(),d("ngIf",e.submitted&&!e.planoSelecionado.valor),p(5),T(S(45,R)),v("visible",e.dialogoExcluirSelecionados),d("modal",!0)("breakpoints",S(46,N)),p(6),I((e.listaPlanosSelecionados==null?null:e.listaPlanosSelecionados.length)||0))},dependencies:[A,z,re,U,se,pe,me,ce,fe,Z,H,Q,K,Y,q,Se,ve,oe,le,ue],styles:[".fab[_ngcontent-%COMP%]{position:fixed!important;z-index:1030!important;right:2rem!important;bottom:2rem!important;width:56px!important;height:56px!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important;animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.1) translateY(-2px)!important;box-shadow:0 8px 16px #0000004d!important}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.list-card[_ngcontent-%COMP%]{position:relative;padding-bottom:100px}@media (max-width: 768px){.fab[_ngcontent-%COMP%]{width:48px!important;height:48px!important;right:1rem!important;bottom:1rem!important;bottom:calc(1rem + env(safe-area-inset-bottom,0px))!important}.fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.1rem!important}.list-card[_ngcontent-%COMP%]{padding-bottom:80px}}[_nghost-%COMP%]{position:relative;min-height:100vh}"]})}}return t})();var Ee=(()=>{class t{static{this.\u0275fac=function(l){return new(l||t)}}static{this.\u0275mod=E({type:t})}static{this.\u0275inj=w({imports:[B.forChild([{path:"",component:ye}]),B]})}}return t})();var Tt=(()=>{class t{static{this.\u0275fac=function(l){return new(l||t)}}static{this.\u0275mod=E({type:t})}static{this.\u0275inj=w({imports:[L,Ee,de,ge,J,$,G,xe,Ce,he,ne,be,ie,X,ae,_e]})}}return t})();export{Tt as PlanoModule};
