import{a as te}from"./chunk-U6KA5TMW.js";import{a as ce,b as ue}from"./chunk-YOAYV4RA.js";import"./chunk-2JY635KS.js";import{a as be,b as xe}from"./chunk-6BD7PSS4.js";import{a as ve,b as _e}from"./chunk-5WWM3MYI.js";import"./chunk-WSDER2HD.js";import"./chunk-T6OX34SV.js";import{b as ge}from"./chunk-MSYTDTXD.js";import{b as X}from"./chunk-4CYYGYMS.js";import{a as ee}from"./chunk-TYLBSFVV.js";import{a as Se,b as he}from"./chunk-DTX2IFH6.js";import"./chunk-3CQIXJFX.js";import{b as fe}from"./chunk-W22XDKEB.js";import"./chunk-4JDA26ZU.js";import{a as le,d as ae,e as se,h as de,i as pe,k as me}from"./chunk-ION2EUQK.js";import"./chunk-XCSSQDET.js";import"./chunk-V5XYQFDX.js";import"./chunk-MZURXKLX.js";import"./chunk-3AW6TXZQ.js";import{c as ne}from"./chunk-LJGI4ZRP.js";import"./chunk-T2PIK6R3.js";import"./chunk-SFTIWTHH.js";import"./chunk-7SPUUUGD.js";import{i as ie}from"./chunk-WSIWJYJX.js";import"./chunk-NJPLBFLS.js";import"./chunk-MDZH7E7N.js";import"./chunk-V6X5IB37.js";import"./chunk-3GJN2BSD.js";import"./chunk-MBI4S36B.js";import"./chunk-6LXUGSQP.js";import{a as oe,b as re}from"./chunk-UGHG6TU3.js";import"./chunk-UAXJ67OE.js";import{b as H,e as Q,g as Y,k as K,n as J}from"./chunk-KLIUDW4T.js";import"./chunk-S35HUXPS.js";import{b as Z,d as $}from"./chunk-4B2QLF32.js";import{k,p as U,s as q,t as G}from"./chunk-BFP4OEA6.js";import{Aa as S,Bb as L,F as y,Ja as N,Ka as m,L as s,La as V,M as d,Ma as F,Oa as x,Pa as C,Qa as w,Ra as W,Sa as h,Ta as j,Tb as P,Y as p,Z as E,da as D,ea as T,ja as g,ma as c,pa as M,rb as A,sa as o,ta as r,tb as z,ua as _,ya as b,za as f}from"./chunk-UX7NIMCO.js";import"./chunk-EQC2ISW6.js";import"./chunk-YT5AF7SN.js";import{a as O,h as I}from"./chunk-MG3ERZGY.js";var Ee=()=>["nome","id"],Te=()=>[10,20,30],R=()=>({width:"450px"}),B=()=>({"960px":"50vw","640px":"90vw"}),Me=t=>({"ng-invalid ng-dirty":t});function ke(t,u){if(t&1){let i=b();o(0,"div",28)(1,"button",29),f("click",function(){s(i);let e=S(2);return d(e.abrirDialogExcluirSelecionados())}),r()()}}function Ie(t,u){t&1&&_(0,"p-fileUpload",32),t&2&&c("maxFileSize",1e6)}function Ve(t,u){t&1&&(o(0,"div",30),g(1,Ie,1,1,"p-fileUpload",31),r()),t&2&&(p(),c("ngIf",!1))}function Fe(t,u){t&1&&(o(0,"p-toolbar",25),g(1,ke,2,0,"ng-template",26)(2,Ve,2,1,"ng-template",27),r())}function Pe(t,u){if(t&1){let i=b();o(0,"div",33)(1,"h5",34),_(2,"i",35),m(3,"Gerenciar Servidores"),r(),o(4,"span",36),_(5,"i",37),o(6,"input",38),f("input",function(e){s(i);let l=S(),v=N(6);return d(l.onGlobalFilter(v,e))}),r()()()}}function Re(t,u){t&1&&(o(0,"th",43),m(1,"Id "),_(2,"p-sortIcon",44),r())}function Be(t,u){t&1&&(o(0,"tr")(1,"th",39),_(2,"p-tableHeaderCheckbox"),r(),g(3,Re,3,0,"th",40),o(4,"th",41),m(5,"Nome "),_(6,"p-sortIcon",42),r(),_(7,"th"),r()),t&2&&(p(3),c("ngIf",!1))}function Oe(t,u){if(t&1&&(o(0,"td")(1,"span",46),m(2,"Id"),r(),m(3),r()),t&2){let i=S().$implicit;p(3),F(" ",i.id," ")}}function De(t,u){if(t&1){let i=b();o(0,"tr")(1,"td"),_(2,"p-tableCheckbox",45),r(),g(3,Oe,4,1,"td",13),o(4,"td")(5,"span",46),m(6,"Nome"),r(),m(7),r(),o(8,"td")(9,"div",47)(10,"button",48),f("click",function(){let e=s(i).$implicit,l=S();return d(l.abrirDialogAlterar(e))}),r(),o(11,"button",49),f("click",function(){let e=s(i).$implicit,l=S();return d(l.abrirDialogExcluir(e))}),r()()()()}if(t&2){let i=u.$implicit;p(2),c("value",i),p(),c("ngIf",!1),p(4),F(" ",i.nome," ")}}function Ne(t,u){if(t&1&&(o(0,"span"),m(1,"Tem certeza que voc\xEA deseja excluir "),o(2,"b"),m(3),r(),m(4,"?"),r()),t&2){let i=S();p(3),V(i.servidorSelecionado.nome)}}function We(t,u){if(t&1){let i=b();o(0,"button",50),f("click",function(){s(i);let e=S();return d(e.dialogoExcluir=!1)}),r(),o(1,"button",51),f("click",function(){s(i);let e=S();return d(e.excluir())}),r()}}function je(t,u){t&1&&(o(0,"small",52),m(1,"Nome \xE9 obrigat\xF3rio."),r())}function Ae(t,u){if(t&1){let i=b();o(0,"button",50),f("click",function(){s(i);let e=S();return d(e.dialogoExcluirSelecionados=!1)}),r(),o(1,"button",51),f("click",function(){s(i);let e=S();return d(e.excluirSelecionados())}),r()}}var we=(()=>{class t{constructor(i,n,e){this.servidorService=i,this.messageService=n,this.clienteService=e,this.listaServidores=[],this.listaServidoresSelecionados=[],this.dialogoExcluir=!1,this.dialogoServidor=!1,this.dialogoExcluirSelecionados=!1,this.servidorSelecionado={},this.cols=[],this.submitted=!1}ngOnInit(){console.log("aqui"),this.cols=[{field:"id",header:"Id"},{field:"nome",header:"Nome"}],this.servidorService.getAll().subscribe({next:i=>this.listaServidores=i,error:i=>console.error(i),complete:()=>console.info("complete")})}salvarOuAlterar(){if(this.submitted=!0,!this.servidorSelecionado.nome||this.servidorSelecionado.nome.trim().length==0){this.messageService.add({severity:"error",summary:"Erro!",detail:"Insira um nome!",life:3e3});return}this.servidorSelecionado.id?this.alterar():this.salvar()}salvar(){this.servidorService.create(this.servidorSelecionado).then(()=>{this.dialogoServidor=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Servidor Criado!",life:3e3}),this.servidorService.getAll().subscribe({next:i=>this.listaServidores=i,error:i=>console.error(i),complete:()=>console.info("complete")})})}abrirDialogAlterar(i){this.servidorSelecionado=O({},i),this.submitted=!1,this.dialogoServidor=!0}alterar(){this.servidorService.update(this.servidorSelecionado).then(()=>{this.dialogoServidor=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Servidor Alterado!",life:3e3}),this.servidorService.getAll().subscribe({next:i=>this.listaServidores=i,error:i=>console.error(i),complete:()=>console.info("complete")})})}abrirDialogExcluir(i){this.submitted=!1,this.servidorSelecionado=i,this.dialogoExcluir=!0}excluir(){return I(this,null,function*(){let n=(yield this.clienteService.getByServidor(this.servidorSelecionado.id||"")).docs.map(e=>e.data());if(n.length>0){let e=n.map(l=>l.nome).join(", ");this.messageService.add({severity:"error",summary:"Erro ao excluir!",detail:`Este servidor n\xE3o pode ser exclu\xEDdo pois est\xE1 sendo utilizado pelos seguintes clientes: ${e}`,life:5e3}),this.dialogoExcluir=!1;return}this.servidorService.delete(this.servidorSelecionado.id||"").then(()=>{console.info("complete"),this.dialogoExcluir=!1,this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Servidor Exclu\xEDdo",life:3e3}),this.servidorSelecionado={},this.servidorService.getAll().subscribe({next:e=>this.listaServidores=e,error:e=>console.error(e),complete:()=>console.info("complete")})})})}onGlobalFilter(i,n){i.filterGlobal(n.target.value,"contains")}novo(){this.dialogoServidor=!0,this.servidorSelecionado={}}abrirDialogExcluirSelecionados(){this.dialogoExcluirSelecionados=!0}excluirSelecionados(){return I(this,null,function*(){if(this.listaServidoresSelecionados){let i=[];for(let n of this.listaServidoresSelecionados){let l=(yield this.clienteService.getByServidor(n.id||"")).docs.map(v=>v.data());l.length>0&&i.push({servidor:n,clientes:l})}if(i.length>0){let n=`Os seguintes servidores n\xE3o podem ser exclu\xEDdos pois est\xE3o sendo utilizados por clientes:
`;i.forEach(e=>{let l=e.clientes.map(v=>v.nome).join(", ");n+=`
\u2022 ${e.servidor.nome}: ${l}`}),this.messageService.add({severity:"error",summary:"Erro ao excluir!",detail:n,life:8e3}),this.dialogoExcluirSelecionados=!1;return}this.listaServidoresSelecionados.forEach(n=>{this.servidorService.delete(n.id||"")}),this.dialogoExcluirSelecionados=!1,this.listaServidoresSelecionados=[],this.messageService.add({severity:"success",summary:"Sucesso!",detail:"Servidores Exclu\xEDdos",life:3e3}),this.servidorService.getAll().subscribe({next:n=>this.listaServidores=n,error:n=>console.error(n),complete:()=>console.info("complete")})}})}static{this.\u0275fac=function(n){return new(n||t)(E(te),E(k),E(ee))}}static{this.\u0275cmp=D({type:t,selectors:[["app-servidor"]],standalone:!1,features:[W([k])],decls:36,vars:41,consts:[["dt",""],[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6","fade-in","list-card"],["styleClass","mb-4 list-toolbar",4,"ngIf"],["styleClass","p-datatable-striped list-table servidores-table","responsiveLayout","stack","currentPageReportTemplate","Mostrando {first} at\xE9 {last} de {totalRecords} registros","selectionMode","multiple","dataKey","id",3,"selectionChange","value","columns","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","selection","rowHover"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pButton","","pRipple","","icon","pi pi-plus",1,"p-button-rounded","p-button-success","fab",3,"click"],["header","Confirmar",3,"visibleChange","visible","modal","breakpoints"],[1,"flex","align-items-center","justify-content-center"],[1,"pi","pi-exclamation-triangle","mr-3",2,"font-size","2rem"],[4,"ngIf"],["pTemplate","footer"],["header","Detalhes do Servidor",1,"p-fluid",3,"visibleChange","visible","breakpoints","modal"],[1,"p-fluid","grid"],[1,"field","col-12"],["for","name"],["type","text","pInputText","","id","name","required","","autofocus","",3,"ngModelChange","ngModel","ngClass"],["class","ng-dirty ng-invalid",4,"ngIf"],[1,"field","col-6"],["pButton","","pRipple","","label","Cancelar","icon","pi pi-times",1,"p-button-danger",3,"click"],["pButton","","pRipple","","label","Salvar","icon","pi pi-check",1,"p-button-success",3,"click"],["header","Confirmar Exclus\xE3o",3,"visibleChange","visible","modal","breakpoints"],["styleClass","mb-4 list-toolbar"],["pTemplate","left"],["pTemplate","right"],[1,"p-toolbar-group-left","flex","flex-wrap","gap-2","w-full"],["pButton","","pRipple","","label","Excluir","icon","pi pi-trash",1,"p-button-danger",3,"click"],[1,"p-toolbar-group-right","flex","flex-wrap","gap-2","w-full","md:w-auto","justify-content-end","mt-2","md:mt-0"],["mode","basic","accept","image/*","label","Import","chooseLabel","Importar","class","inline-block",3,"maxFileSize",4,"ngIf"],["mode","basic","accept","image/*","label","Import","chooseLabel","Importar",1,"inline-block",3,"maxFileSize"],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"m-0"],[1,"pi","pi-server","mr-2"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Procurar...",1,"w-full","sm:w-auto",3,"input"],[2,"width","3rem"],["pSortableColumn","id",4,"ngIf"],["pSortableColumn","nome"],["field","nome"],["pSortableColumn","id"],["field","id"],[3,"value"],[1,"p-column-title"],[1,"flex"],["pButton","","pRipple","","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-trash",1,"p-button-rounded","p-button-warning",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","N\xE3o",1,"p-button-text",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","Sim",1,"p-button-text",3,"click"],[1,"ng-dirty","ng-invalid"]],template:function(n,e){if(n&1){let l=b();o(0,"div",1)(1,"div",2)(2,"div",3),_(3,"p-toast"),g(4,Fe,3,0,"p-toolbar",4),o(5,"p-table",5,0),w("selectionChange",function(a){return s(l),C(e.listaServidoresSelecionados,a)||(e.listaServidoresSelecionados=a),d(a)}),g(7,Pe,7,0,"ng-template",6)(8,Be,8,1,"ng-template",7)(9,De,12,3,"ng-template",8),r()(),o(10,"button",9),f("click",function(){return s(l),d(e.novo())}),r(),o(11,"p-dialog",10),w("visibleChange",function(a){return s(l),C(e.dialogoExcluir,a)||(e.dialogoExcluir=a),d(a)}),o(12,"div",11),_(13,"i",12),g(14,Ne,5,1,"span",13),r(),g(15,We,2,0,"ng-template",14),r(),o(16,"p-dialog",15),w("visibleChange",function(a){return s(l),C(e.dialogoServidor,a)||(e.dialogoServidor=a),d(a)}),o(17,"div",16)(18,"div",17)(19,"label",18),m(20,"Nome"),r(),o(21,"input",19),w("ngModelChange",function(a){return s(l),C(e.servidorSelecionado.nome,a)||(e.servidorSelecionado.nome=a),d(a)}),r(),g(22,je,2,0,"small",20),r(),o(23,"div",21)(24,"button",22),f("click",function(){return s(l),d(e.dialogoServidor=!1)}),r()(),o(25,"div",21)(26,"button",23),f("click",function(){return s(l),d(e.salvarOuAlterar())}),r()()()(),o(27,"p-dialog",24),w("visibleChange",function(a){return s(l),C(e.dialogoExcluirSelecionados,a)||(e.dialogoExcluirSelecionados=a),d(a)}),o(28,"div",11),_(29,"i",12),o(30,"span"),m(31,"Tem certeza que voc\xEA deseja excluir os "),o(32,"b"),m(33),r(),m(34," servidores selecionados?"),r()(),g(35,Ae,2,0,"ng-template",14),r()()()}n&2&&(p(4),c("ngIf",e.listaServidoresSelecionados&&e.listaServidoresSelecionados.length>0),p(),c("value",e.listaServidores)("columns",e.cols)("rows",10)("globalFilterFields",h(31,Ee))("rows",10)("paginator",!0)("rowsPerPageOptions",h(32,Te))("showCurrentPageReport",!0),x("selection",e.listaServidoresSelecionados),c("rowHover",!0),p(6),M(h(33,R)),x("visible",e.dialogoExcluir),c("modal",!0)("breakpoints",h(34,B)),p(3),c("ngIf",e.servidorSelecionado),p(2),M(h(35,R)),x("visible",e.dialogoServidor),c("breakpoints",h(36,B))("modal",!0),p(5),x("ngModel",e.servidorSelecionado.nome),c("ngClass",j(37,Me,e.submitted&&!e.servidorSelecionado.nome)),p(),c("ngIf",e.submitted&&!e.servidorSelecionado.nome),p(5),M(h(39,R)),x("visible",e.dialogoExcluirSelecionados),c("modal",!0)("breakpoints",h(40,B)),p(6),V((e.listaServidoresSelecionados==null?null:e.listaServidoresSelecionados.length)||0))},dependencies:[A,z,le,U,ae,se,de,pe,ve,Z,H,Q,K,Y,q,Se,be,oe,ce],styles:[".fab[_ngcontent-%COMP%]{position:fixed!important;z-index:1030!important;right:2rem!important;bottom:2rem!important;width:56px!important;height:56px!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important;animation:_ngcontent-%COMP%_fadeInUp .4s ease-out}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.1) translateY(-2px)!important;box-shadow:0 8px 16px #0000004d!important}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.list-card[_ngcontent-%COMP%]{position:relative;padding-bottom:100px}@media (max-width: 768px){.fab[_ngcontent-%COMP%]{width:48px!important;height:48px!important;right:1rem!important;bottom:1rem!important;bottom:calc(1rem + env(safe-area-inset-bottom,0px))!important}.fab[_ngcontent-%COMP%]   .pi[_ngcontent-%COMP%]{font-size:1.1rem!important}.list-card[_ngcontent-%COMP%]{padding-bottom:80px}}[_nghost-%COMP%]{position:relative;min-height:100vh}"]})}}return t})();var ye=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=y({imports:[P.forChild([{path:"",component:we}]),P]})}}return t})();var yt=(()=>{class t{static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275mod=T({type:t})}static{this.\u0275inj=y({imports:[L,ye,me,_e,J,$,G,he,xe,ge,re,fe,ie,X,ne,ue]})}}return t})();export{yt as ServidorModule};
