import{d as a,e as g,g as q,h as B,i as w,j,k as F,l as H,o as h,p as c,q as $,r as e}from"./chunk-UW4E5NSV.js";import{E as D,H as m}from"./chunk-UX7NIMCO.js";import{a as b,h as y}from"./chunk-MG3ERZGY.js";var x=(()=>{class u{constructor(t){this.firestore=t,this.dbHistorico=j(this.firestore,"historico-renovacoes")}getAll(){return q(this.dbHistorico,{idField:"id"})}get(t){let o=H(this.firestore,`historico-renovacoes/${t}`);return B(o,{idField:"id"})}create(t){return w(this.dbHistorico,t)}update(t){let o=H(this.firestore,`historico-renovacoes/${t.id}`);return $(o,b({},t))}delete(t){let o=H(this.firestore,`historico-renovacoes/${t}`);return F(o)}getAllOrderByDataRenovacao(){let t=c(this.dbHistorico,h("dataHoraRenovacao","desc"));return a(t)}getByCliente(t){let o=c(this.dbHistorico,e("cliente.id","==",t));return a(o)}getByPlano(t){let o=c(this.dbHistorico,e("plano.id","==",t));return a(o)}getByServidor(t){let o=c(this.dbHistorico,e("servidor.id","==",t));return a(o)}getByPeriodo(t,o){let n=c(this.dbHistorico,e("dataHoraRenovacao",">=",t),e("dataHoraRenovacao","<=",o),h("dataHoraRenovacao","desc"));return a(n)}getByFiltros(t,o,n,l,f){return y(this,null,function*(){if((t?1:0)+(o?1:0)+(n?1:0)+(l&&f?1:0)>1){let r=c(this.dbHistorico,h("dataHoraRenovacao","desc")),p=yield a(r),s=p.docs;return t&&(s=s.filter(d=>{let i=d.data();return i.cliente&&i.cliente.id===t})),o&&(s=s.filter(d=>{let i=d.data();return i.plano&&i.plano.id===o})),n&&(s=s.filter(d=>{let i=d.data();return i.servidor&&i.servidor.id===n})),l&&f&&(s=s.filter(d=>{let v=d.data().dataHoraRenovacao;if(!v)return!1;let R=v.seconds?new Date(v.seconds*1e3):v;return R>=l&&R<=f})),p}else{let r=[];t&&r.push(e("cliente.id","==",t)),o&&r.push(e("plano.id","==",o)),n&&r.push(e("servidor.id","==",n)),l&&f&&(r.push(e("dataHoraRenovacao",">=",l)),r.push(e("dataHoraRenovacao","<=",f))),r.push(h("dataHoraRenovacao","desc"));let p=c(this.dbHistorico,...r);return a(p)}})}static{this.\u0275fac=function(o){return new(o||u)(m(g))}}static{this.\u0275prov=D({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})();export{x as a};
